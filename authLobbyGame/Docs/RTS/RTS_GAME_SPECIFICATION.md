# RTS 게임 명세서 (Real-Time Strategy Game Specification)

## 1. 게임 개요

### 1.1 게임 타입
- **장르**: 실시간 전략 게임 (RTS)
- **플레이어 수**: 2~8명
- **게임 모드**: 
  - 1v1 대전
  - 팀 전투 (2v2, 3v3)
  - 자유전투 (FFA: Free For All)
- **게임 지속시간**: 10분~1시간
- **플레이 스타일**: 
  - 자원 채취
  - 유닛 생산 및 관리
  - 건물 건설
  - 전술적 전투

### 1.2 핵심 시스템
1. **자원 시스템**: 다중 자원 채취 및 관리
2. **유닛 시스템**: 유닛 생산, 이동, 공격
3. **건물 시스템**: 건설, 업그레이드, 특수 능력
4. **기술 시스템**: 기술 트리, 업그레이드
5. **포그 오브 워**: 안개 시스템으로 제한된 시야
6. **승리 조건**: 적군 기지 파괴 또는 점수 달성

---

## 2. 맵 시스템

### 2.1 맵 구조
```
맵 크기: 128x128 ~ 512x512 타일
타일 크기: 32x32 픽셀
총 가능 유닛 수: 200~500개 (플레이어당 제한)
시작 위치: 맵 모서리 또는 특정 위치 지정
```

### 2.2 지형 종류
| 지형 | 통과성 | 속도 | 설명 |
|------|--------|------|------|
| 초원 | 가능 | 100% | 기본 지형 |
| 산악 | 불가능 | 0% | 장애물, 시야 차단 |
| 물 | 선택적 | 50% | 수중 유닛만 통과 |
| 도로 | 가능 | 120% | 속도 증가 지형 |
| 용암 | 불가능 | 0% | 환경 피해 |

### 2.3 자원 위치
- **광물 광산**: 50~100개 자동 배치
- **가스 간선**: 20~50개 자동 배치
- **식량 동물**: 30~80개 자동 배치
- **금고**: 각 플레이어 시작 위치에 1개씩 배치

### 2.4 초기화 데이터
```json
{
  "map_id": "map_001",
  "map_name": "Lost Temple",
  "width": 256,
  "height": 256,
  "tile_size": 32,
  "players": 2,
  "start_positions": [
    {"x": 100, "y": 100},
    {"x": 400, "y": 400}
  ],
  "resources": [
    {"type": "mineral", "x": 150, "y": 150, "amount": 1500},
    {"type": "gas", "x": 200, "y": 200, "amount": 300}
  ],
  "obstacles": [...],
  "visibility_range": 15
}
```

---

## 3. 자원 시스템

### 3.1 자원 타입

| 자원 | 설명 | 최대 보유 | 생성 방식 | 사용처 |
|------|------|---------|---------|-------|
| **광물** | 기본 건설 자원 | 5000 | 광산 채취 | 건물, 유닛 |
| **가스** | 고급 유닛/건물 | 2000 | 간선 채취 | 고급 유닛, 기술 |
| **식량** | 유닛 인구 제한 | N/A | 농장/동물 사냥 | 인구 제한 |
| **에너지** | 건물 가동 자원 | 1000 | 발전소 생산 | 특수 건물 |

### 3.2 자원 채취
```
광물 채취:
- 일꾼 1명 = 초당 0.5 광물
- 채취 거리: 3타일 이내
- 자동 운반: 집하장까지 자동 반환

가스 채취:
- 일꾼 1명 = 초당 0.3 가스
- 채취 거리: 5타일 이내
- 자동 운반: 집하장까지 자동 반환

식량 채취:
- 동물 1마리 = 100 식량
- 농장 = 초당 0.2 식량 생산
- 누적 가능: 최대 200까지
```

### 3.3 식량 시스템
```
제공 식량:
- 기본 식량: 15 (게임 시작)
- 농장당: +10 식량
- 동물 사냥당: +100 식량

인구 계산:
- 일꾼: 1 인구
- 보병: 1 인구
- 기병: 2 인구
- 전차: 3 인구
- 비행기: 2 인구
```

---

## 4. 유닛 시스템

### 4.1 유닛 분류

#### 기초 유닛
| 유닛 | 비용 | 생산시간 | 체력 | 공격력 | 이동속도 | 설명 |
|------|------|---------|------|--------|---------|------|
| 일꾼 | 50M | 4초 | 25 | 1 | 2.5 | 자원 채취, 건설 |
| 보병 | 100M | 6초 | 50 | 5 | 3 | 기본 전투 유닛 |
| 궁수 | 100M 50G | 8초 | 35 | 8 | 2.5 | 원거리 공격 |

#### 중급 유닛
| 유닛 | 비용 | 생산시간 | 체력 | 공격력 | 이동속도 | 설명 |
|------|------|---------|------|--------|---------|------|
| 기병 | 150M 100G | 10초 | 80 | 10 | 4.5 | 빠른 이동, 강한 공격 |
| 마법사 | 100M 150G | 12초 | 40 | 12 | 2.5 | 범위 마법 공격 |

#### 고급 유닛
| 유닛 | 비용 | 생산시간 | 체력 | 공격력 | 이동속도 | 설명 |
|------|------|---------|------|--------|---------|------|
| 전차 | 200M 200G | 15초 | 150 | 20 | 2 | 강한 공격력 |
| 용사 | 150M 150G | 10초 | 120 | 15 | 3.5 | 강력한 근접 전사 |

### 4.2 유닛 상태
```
상태 종류:
- 이동: 목표 위치로 이동 중
- 공격: 목표 적군 공격 중
- 채취: 자원 채취 중
- 건설: 건물 건설 중
- 유휴: 명령 대기 중
- 죽음: 제거 대기

상태 전환:
유휴 → 이동 → 공격/채취/건설 → 유휴 또는 죽음
```

### 4.3 유닛 제어 시스템
```
명령 종류:
1. 이동: 클릭 위치로 이동
2. 공격: 목표 선택 공격
3. 정지: 현재 명령 중단
4. 집결: 선택된 위치에 모음
5. 자동 방어: 공격받으면 자동 반격

명령 우선순위:
- 공격 명령 > 이동 명령 > 자동 방어
```

---

## 5. 건물 시스템

### 5.1 건물 목록

#### 기초 건물
| 건물 | 비용 | 건설시간 | 체력 | 설명 |
|------|------|---------|------|------|
| 기지 | 기본 | 0초 | 500 | 시작 건물, 핵심 시설 |
| 집하장 | 100M | 20초 | 300 | 자원 저장, 작업자 반환 |
| 병영 | 150M 100G | 25초 | 200 | 보병, 궁수 생산 |

#### 중급 건물
| 건물 | 비용 | 건설시간 | 체력 | 설명 |
|------|------|---------|------|------|
| 마병사관 | 150M 150G | 30초 | 250 | 기병, 용사 생산 |
| 마법사탑 | 100M 200G | 35초 | 150 | 마법사 생산 |
| 방어탑 | 75M 50G | 15초 | 250 | 자동 방어 시설 |

#### 고급 건물
| 건물 | 비용 | 건설시간 | 체력 | 설명 |
|------|------|---------|------|------|
| 전차고 | 200M 200G | 40초 | 300 | 전차 생산 |
| 비행장 | 150M 250G | 45초 | 250 | 비행기 생산 |

#### 경제 건물
| 건물 | 비용 | 건설시간 | 체력 | 설명 |
|------|------|---------|------|------|
| 농장 | 50M | 10초 | 100 | 식량 생산 +10 |
| 발전소 | 100M 50G | 20초 | 150 | 에너지 생산 |

### 5.2 건설 시스템
```
건설 순서:
1. 플레이어가 건설 위치 선택
2. 필요 자원 확인
3. 일꾼 배정
4. 건설 시작 (건설 시간만큼)
5. 건설 완료

건설 취소:
- 건설 중 취소 가능
- 자원의 50% 환급

건설 조건:
- 필요 자원 보유
- 인접 건물 또는 경로 확인
- 유효한 지형
```

### 5.3 건물 업그레이드
```
업그레이드 종류:
1. 무장 업그레이드: +1 공격력
2. 갑옷 업그레이드: +10% 방어력
3. 생산 속도 업그레이드: -5% 생산 시간
4. 자원 채취 업그레이드: +10% 채취 효율

업그레이드 조건:
- 특정 건물 또는 기술 필요
- 자원 소비
- 시간 소비 (병렬 업그레이드 불가)
```

---

## 6. 기술 트리 및 시스템

### 6.1 기술 구조
```
초급 기술:
├─ 개선된 도구 (+5% 자원 채취)
├─ 기본 전술 (+1 유닛 공격력)
└─ 강화 보병 (+10 체력)

중급 기술:
├─ 고급 도구 (+10% 자원 채취)
├─ 기병 훈련
└─ 마법 입문

고급 기술:
├─ 최고급 도구 (+15% 자원 채취)
├─ 용사 훈련
└─ 마법 대학
```

### 6.2 기술 연구
```
연구 설정:
- 건물(기술실)에서 연구 시작
- 연구 시간 동안 다른 작업 가능
- 한 번에 1개 기술만 연구 가능
- 기술 완료 후 보너스 즉시 적용
```

---

## 7. 포그 오브 워 (Fog of War)

### 7.1 시야 시스템
```
플레이어 시야:
- 기본 시야: 15 타일
- 유닛별 시야:
  - 일꾼: 8 타일
  - 보병: 10 타일
  - 궁수: 12 타일
  - 기병: 11 타일
  - 마법사: 13 타일

포그 상태:
1. 탐험됨: 이전에 본 지형 (흐린 상태)
2. 가시: 현재 보이는 영역 (명확함)
3. 안개: 본 적 없는 영역 (완전 어두움)
```

### 7.2 포그 동기화
```
서버 처리:
1. 각 플레이어의 시야 범위 계산
2. 시야 범위 내 유닛/건물만 전송
3. 적군 유닛 은폐 처리
4. 100ms마다 동기화

클라이언트 렌더링:
- 가시 영역: 명확한 그래픽
- 탐험됨: 그레이스케일 또는 투명
- 안개: 완전 검은색
```

---

## 8. 승리 조건

### 8.1 일반 승리
- **기지 파괴**: 적의 기지 건물 파괴 (가장 흔함)
- **경제 우위**: 지정된 자원 축적 (선택적)
- **점수 승리**: 지정된 점수 달성 (선택적)

### 8.2 항복 및 패배
```
항복 조건:
- 플레이어가 직접 항복
- 자동 항복: 일정 시간 활동 없음

패배 표시:
- 기지 건물 파괴
- 플레이어가 모든 유닛 상실 + 재생산 불가

항복 페널티:
- 통계 기록 (패배로 기록)
- 평정 점수 감소
```

---

## 9. 게임 플로우

### 9.1 게임 시작
```
1. 로비 서버: 플레이어 모두 준비 확인
2. 게임 서버: 게임 초기화
   - 맵 로드
   - 플레이어 기지 배치
   - 초기 자원 배분 (500M, 100G, 15 식량)
   - 모든 클라이언트에 게임 시작 신호
3. 클라이언트: UI 렌더링, 게임 시작
4. 게임 루프 시작 (100ms 틱)
```

### 9.2 게임 진행
```
매 프레임 처리:
1. 플레이어 명령 수집 (TCP)
2. 명령 유효성 검사
3. 게임 로직 실행
   - 자원 채취 계산
   - 유닛 이동/공격 처리
   - 건설 진행도 업데이트
   - 데미지 계산
4. 게임 상태 변경
5. 동기화 패킷 생성 및 전송 (UDP)
6. 죽은 객체 제거
```

### 9.3 게임 종료
```
1. 승리 조건 감지
   - 기지 파괴 확인
   - 점수 확인
   - 모든 플레이어 패배 확인
2. 승자 결정
3. 게임 결과 저장 (MySQL)
4. 통계 업데이트
5. 클라이언트에 게임 종료 신호
6. 로비로 복귀
```

---

## 10. 균형 설정 (Balancing)

### 10.1 자원 밸런싱
```
초기 자원:
- 광물: 500 (게임 진행 시 200M 필요)
- 가스: 100
- 식량: 15 (충분한 건설용)

시간당 자원 획득:
- 광물: 일꾼 1명당 30M/분 × 3명 = 90M/분
- 가스: 일꾼 1명당 18G/분 × 2명 = 36G/분
- 식량: 농장 1개당 12 식량/분

예상 게임 지속 시간:
- 초기 자원으로 기본 유닛 생산: 1~2분
- 공격 시작: 5~10분
- 게임 종료: 30분 ± 15분
```

### 10.2 유닛 밸런싱
```
비용 대비 성능:
- 보병: 100M = 기본 전투 1.0x 성능
- 궁수: 100M 50G = 기본 전투 1.6x 성능 (비용 1.5배)
- 기병: 150M 100G = 기본 전투 2.0x 성능 (비용 2.5배)

이동 속도:
- 보병: 3 (기준)
- 기병: 4.5 (1.5배, 비용 2.5배로 과하지 않음)
- 비행기: 6 (가장 빠름)

승리 조건 분석:
- 같은 비용이면 보병 vs 궁수 = 50% 확률
- 같은 비용이면 보병 vs 기병 = 보병 60%, 기병 40% (기병이 우수)
```

---

## 11. 플레이어 경험 (UX)

### 11.1 UI 요소
```
HUD (Heads-Up Display):
- 자원 표시 (왼쪽 상단)
- 인구 표시
- 미니맵 (오른쪽 상단)
- 선택된 유닛 정보 (왼쪽 하단)
- 생산 큐 (하단 중앙)
- 건설 메뉴 (우측)

정보 패널:
- 유닛 선택: 체력, 경험치, 능력
- 건물 선택: 생산 큐, 업그레이드 상태
- 기술 정보: 연구 진행도
```

### 11.2 입력 처리
```
마우스 입력:
- 좌클릭: 유닛/건물 선택
- 우클릭: 명령 (이동/공격/건설)
- 드래그: 다중 선택
- 휠: 줌 인/아웃

키보드 입력:
- 1~9: 그룹 선택 (저장된 그룹)
- 스페이스: 마지막 이벤트로 이동
- 일시정지: P 키 (싱글플레이만)
```

---

## 12. 성능 최적화

### 12.1 네트워크 최적화
```
대역폭 절감:
1. 명령 배치: 100ms마다 한 번에 전송
2. 중요도 기반 동기화:
   - 중요(체력 변화): 매 프레임
   - 보통(위치 이동): 200ms마다
   - 낮음(자원): 500ms마다
3. 델타 동기화: 변경된 데이터만 전송
4. 압축: 패킷 데이터 압축
```

### 12.2 게임 로직 최적화
```
CPU 최적화:
1. 공간 분할: 쿼드트리로 충돌 검사 범위 축소
2. LOD (Level of Detail): 멀리 있는 유닛은 낮은 정확도
3. 일괄 처리: 같은 타입 유닛 함께 처리
4. 멀티스레딩: 게임 로직과 네트워크 처리 분리

메모리 최적화:
1. 객체 풀링: 유닛/건물 객체 재사용
2. 텍스처 아틀라싱: 메모리 효율
3. 가비지 수집 최소화: 할당 구조 최적화
```

---

## 13. 테스트 시나리오

### 13.1 기능 테스트
```
자원 시스템:
- [ ] 자원 채취 수량 검증
- [ ] 자원 제한 초과 확인
- [ ] 자원 환급 계산

유닛 시스템:
- [ ] 유닛 생산 시간 정확성
- [ ] 유닛 이동 경로 찾기
- [ ] 유닛 공격 계산
- [ ] 유닛 사망 처리

건물 시스템:
- [ ] 건물 건설 시간
- [ ] 건물 배치 유효성
- [ ] 건물 파괴 시 자원 반환

포그 오브 워:
- [ ] 시야 범위 계산 정확성
- [ ] 탐험됨/가시/안개 상태 전환
```

### 13.2 성능 테스트
```
스트레스 테스트:
- [ ] 200+ 유닛 동시 처리
- [ ] 50+ 건물 관리
- [ ] 네트워크 250ms 지연 처리
- [ ] 패킷 손실 시뮬레이션

동기화 테스트:
- [ ] 플레이어 간 상태 일치성
- [ ] 재연결 시 상태 복구
- [ ] 타이밍 정확성 (±50ms)
```

---

## 14. 참고 게임

- **StarCraft**: 실시간 RTS의 정점
- **Warcraft III**: 영웅 시스템과 복잡한 마법
- **Age of Empires**: 대규모 멀티플레이어
- **Command & Conquer**: 단순하면서도 균형잡힌 설계

